{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\PIONEER\\\\Documents\\\\projects\\\\endurance-sample\\\\srabonti-sample-ui\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\PIONEER\\\\Documents\\\\projects\\\\endurance-sample\\\\srabonti-sample-ui\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"C:\\\\Users\\\\PIONEER\\\\Documents\\\\projects\\\\endurance-sample\\\\srabonti-sample-ui\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"C:\\\\Users\\\\PIONEER\\\\Documents\\\\projects\\\\endurance-sample\\\\srabonti-sample-ui\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";\nimport { useState, useReducer, useCallback } from \"react\";\nimport { useCookies } from 'react-cookie';\nimport apiConfigInfo from '../api/apiConfig';\nimport { isNullOrUndefined } from \"util\";\nimport * as PortalConstants from \"../utility/constants\";\n\nrequire('isomorphic-fetch');\n\nvar HTTP_STATUS_OK = 200;\nvar HTTP_BAD_REQUEST = 400;\nvar HTTP_UNAUTHORIZED = 401;\nvar HTTP_NO_CONTENT = 404;\nvar HTTP_SERVER_FAILURE = 500;\n\nvar dataFetchReducer = function dataFetchReducer(state, action) {\n  switch (action.type) {\n    case \"FETCH_INIT\":\n      return _objectSpread(_objectSpread({}, state), {}, {\n        isLoading: true,\n        isError: false\n      });\n\n    case \"FETCH_SUCCESS\":\n      var data = [];\n      var hasResponseData = false;\n\n      if (!isNullOrUndefined(action.payload.result.responseData)) {\n        data = action.payload.result.responseData;\n        hasResponseData = true;\n      }\n\n      var result = action.payload.status === HTTP_STATUS_OK ? _objectSpread(_objectSpread({}, state), {}, {\n        data: hasResponseData ? data : action.payload.result,\n        error: null,\n        hasError: false,\n        isLoading: false,\n        success: true\n      }) : _objectSpread(_objectSpread({}, state), {}, {\n        data: null,\n        error: action.payload.result.responseStatus ? action.payload.result.responseStatus : {\n          errorMessage: [{\n            key: \"generic.error\",\n            message: \"We are having some technical difficulties please try again later.\"\n          }],\n          \"httpStatusCode\": HTTP_SERVER_FAILURE,\n          \"statusDesc\": \"ServerFailure\"\n        },\n        hasError: true,\n        isLoading: false\n      });\n      return result;\n\n    case \"FETCH_FAILURE\":\n      return _objectSpread(_objectSpread({}, state), {}, {\n        data: null,\n        error: action.payload.responseStatus ? action.payload.responseStatus : {\n          errorMessage: [{\n            key: \"generic.error\",\n            message: \"We are having some technical difficulties please try again later.\"\n          }],\n          \"httpStatusCode\": HTTP_SERVER_FAILURE,\n          \"statusDesc\": \"ServerFailure\"\n        },\n        hasError: true,\n        isLoading: false\n      });\n\n    default:\n      return null;\n  }\n};\n\nfunction getDataApiOptions(method, requestBody, authorization) {\n  var options = {\n    method: method,\n    headers: {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n      'Authorization': 'Bearer ' + authorization\n    }\n  };\n\n  if (!isNullOrUndefined(requestBody)) {\n    options.body = JSON.stringify(requestBody);\n  }\n\n  return options;\n}\n\nvar useApi = function useApi(apiPath, body, method) {\n  var _useCookies = useCookies(),\n      _useCookies2 = _slicedToArray(_useCookies, 1),\n      cookie = _useCookies2[0];\n\n  var options = getDataApiOptions(method, body, cookie[PortalConstants.AUTH_TOKEN]);\n\n  var _useState = useState(apiConfigInfo.url + apiPath),\n      _useState2 = _slicedToArray(_useState, 1),\n      url = _useState2[0];\n\n  var _useReducer = useReducer(dataFetchReducer, {\n    isLoading: null,\n    hasError: false,\n    errorMessage: \"\",\n    data: null,\n    request: body\n  }),\n      _useReducer2 = _slicedToArray(_useReducer, 2),\n      state = _useReducer2[0],\n      dispatch = _useReducer2[1];\n\n  var callApi = useCallback( /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(body, method, newAPIPath) {\n      var APIUrl, didCancel, fetchRequest, response, status, result;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              APIUrl = url;\n\n              if (newAPIPath) {\n                APIUrl = apiConfigInfo.url + newAPIPath;\n              }\n\n              didCancel = false;\n\n              if (body) {\n                options.body = JSON.stringify(body);\n              }\n\n              options.method = method;\n              dispatch({\n                type: \"FETCH_INIT\"\n              });\n              fetchRequest = new Request(APIUrl, options);\n              _context.prev = 7;\n              _context.next = 10;\n              return fetch(fetchRequest);\n\n            case 10:\n              response = _context.sent;\n              status = response.status;\n              _context.next = 14;\n              return response.json();\n\n            case 14:\n              result = _context.sent;\n\n              if (!didCancel) {\n                dispatch({\n                  type: \"FETCH_SUCCESS\",\n                  payload: {\n                    result: result,\n                    status: status\n                  }\n                });\n              }\n\n              _context.next = 21;\n              break;\n\n            case 18:\n              _context.prev = 18;\n              _context.t0 = _context[\"catch\"](7);\n\n              if (!didCancel) {\n                dispatch({\n                  type: \"FETCH_FAILURE\",\n                  payload: _context.t0\n                });\n              }\n\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[7, 18]]);\n    }));\n\n    return function (_x, _x2, _x3) {\n      return _ref.apply(this, arguments);\n    };\n  }(), [url, state.request]);\n  return [state, callApi];\n};\n\nexport default useApi;","map":{"version":3,"sources":["C:/Users/PIONEER/Documents/projects/endurance-sample/srabonti-sample-ui/src/hooks/useApi.js"],"names":["useState","useReducer","useCallback","useCookies","apiConfigInfo","isNullOrUndefined","PortalConstants","require","HTTP_STATUS_OK","HTTP_BAD_REQUEST","HTTP_UNAUTHORIZED","HTTP_NO_CONTENT","HTTP_SERVER_FAILURE","dataFetchReducer","state","action","type","isLoading","isError","data","hasResponseData","payload","result","responseData","status","error","hasError","success","responseStatus","errorMessage","key","message","getDataApiOptions","method","requestBody","authorization","options","headers","body","JSON","stringify","useApi","apiPath","cookie","AUTH_TOKEN","url","request","dispatch","callApi","newAPIPath","APIUrl","didCancel","fetchRequest","Request","fetch","response","json"],"mappings":"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","sourcesContent":["import { useState, useReducer, useCallback } from \"react\";\nimport { useCookies } from 'react-cookie';\nimport apiConfigInfo from '../api/apiConfig';\nimport { isNullOrUndefined } from \"util\"; \nimport * as PortalConstants from \"../utility/constants\";\nrequire('isomorphic-fetch');\n\n \n const HTTP_STATUS_OK = 200;\n const HTTP_BAD_REQUEST = 400;\n const HTTP_UNAUTHORIZED= 401;\n const HTTP_NO_CONTENT=404;\n const HTTP_SERVER_FAILURE = 500;\n\nconst dataFetchReducer = (state, action) => {\n  switch (action.type) {\n    case \"FETCH_INIT\":\n      return { ...state, isLoading: true, isError: false };\n    case \"FETCH_SUCCESS\":\n      let data = [];\n      let hasResponseData = false;\n      if (!isNullOrUndefined(action.payload.result.responseData)) {\n        data = action.payload.result.responseData;\n        hasResponseData = true;\n      }\n      \n      let result =\n        action.payload.status === HTTP_STATUS_OK ? {\n          ...state,\n          data: hasResponseData? data:  action.payload.result,\n          error: null,\n          hasError: false,\n          isLoading: false,\n          success: true\n        }\n\n          : {\n            ...state,\n            data: null,\n            error: action.payload.result.responseStatus ? action.payload.result.responseStatus : {\n              errorMessage: [{\n                key: \"generic.error\",\n                message: \"We are having some technical difficulties please try again later.\"\n              }],\n              \"httpStatusCode\": HTTP_SERVER_FAILURE,\n              \"statusDesc\": \"ServerFailure\"\n            },\n            hasError: true,\n\n            isLoading: false\n          };\n      return result;\n    case \"FETCH_FAILURE\":\n      return {\n        ...state,\n        data: null,\n        error: action.payload.responseStatus ? action.payload.responseStatus : {\n          errorMessage: [{\n            key: \"generic.error\",\n            message: \"We are having some technical difficulties please try again later.\"\n          }],\n          \"httpStatusCode\": HTTP_SERVER_FAILURE,\n          \"statusDesc\": \"ServerFailure\"\n        },\n        hasError: true,\n        isLoading: false\n      }\n    default:\n      return null;\n\n  }\n};\n\nfunction getDataApiOptions(method, requestBody, authorization) {\n  let options = {\n    method: method,\n    headers: {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json',\n      'Authorization': 'Bearer ' + authorization\n    }\n  }\n  if (!isNullOrUndefined(requestBody)) {\n    options.body = JSON.stringify(requestBody);\n  }\n  return options;\n}\n\nconst useApi = (apiPath, body, method) => {\n\n  const [cookie] = useCookies();\n  let options = getDataApiOptions(method, body, cookie[PortalConstants.AUTH_TOKEN]);\n\n  const [url] = useState(apiConfigInfo.url + apiPath);\n\n\n  const [state, dispatch] = useReducer(dataFetchReducer, {\n    isLoading: null,\n    hasError: false,\n    errorMessage: \"\",\n    data: null,\n    request: body\n  });\n\n  const callApi = useCallback(async (body, method, newAPIPath) => {\n    let APIUrl = url;\n    if (newAPIPath) {\n      APIUrl = apiConfigInfo.url + newAPIPath;\n    }\n\n    let didCancel = false;\n    if (body) {\n      options.body = JSON.stringify(body);\n    }\n    options.method = method;\n    dispatch({ type: \"FETCH_INIT\" });\n    const fetchRequest = new Request(APIUrl, options);\n    try {\n      let response = await fetch(fetchRequest);\n\n      let status = response.status;\n      let result = await response.json();\n\n      if (!didCancel) {\n        dispatch({ type: \"FETCH_SUCCESS\", payload: { result, status } });\n      }\n    } catch (error) {\n      if (!didCancel) {\n        dispatch({ type: \"FETCH_FAILURE\", payload: error });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [url, state.request]);\n\n  return [state, callApi];\n};\n\nexport default useApi;"]},"metadata":{},"sourceType":"module"}